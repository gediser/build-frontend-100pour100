var V=Object.defineProperty;var g=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var p=(r,o,t)=>o in r?V(r,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[o]=t,h=(r,o)=>{for(var t in o||(o={}))j.call(o,t)&&p(r,t,o[t]);if(g)for(var t of g(o))L.call(o,t)&&p(r,t,o[t]);return r};import{k as S,l as M,e as f,s as n,m as B,p as D,o as l,c as N,w as b,d as e,t as _,u as i,b as c,j as R,q as v,v as F,F as O,h as U,x as A,y as E,a as y}from"./index.e6c525bd.js";import{_ as H}from"./PageComponent.acd1bbc4.js";const I={class:"flex items-center justify-between"},J={class:"text-3xl font-bold text-gray-900"},T=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 -mt-1 inline-block",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),$=y(" Supprimer Publication "),q=[T,$],z={key:0,class:"flex justify-center"},G=["onSubmit"],K={class:"shadow sm:rounded-md sm:overflow-hidden"},Q={class:"px-4 py-5 bg-white space-y-6 sm:p-6"},W=e("label",{class:"block text-sm font-medium text-gray-700"}," Image ",-1),X={class:"mt-1 flex items-center"},Y=["src","alt"],Z={key:1,class:"flex items-center justify-center h-12 w-12 rounded-full overflow-hidden bg-gray-100"},ee=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-[80%] w-[80%] text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),te=[ee],oe={type:"button",class:"relative overflow-hidden ml-5 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},se=y(" Changer "),ie=e("label",{for:"category",class:"block text-sm font-medium text-gray-700"},"Categorie",-1),ae=e("option",null,"Choisir une categorie",-1),ne=["value"],re=e("label",{for:"about",class:"block text-sm font-medium text-gray-700"}," Description ",-1),le={class:"mt-1"},de=e("div",{class:"px-4 py-3 bg-gray-50 text-right sm:px-6"},[e("button",{type:"submit",class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:offset-2 focus-ring-indigo-500"}," Save ")],-1),ge={setup(r){const o=S(),t=M(),w=f(()=>n.state.currentPublication.loading),m=f(()=>n.state.categories);let s=B({image:null,description:null,image_url:null,category_id:null});D(()=>n.state.currentPublication.data,(u,d)=>{s.value=h({},JSON.parse(JSON.stringify(u)))}),m.loaded||n.dispatch("getCategories"),t.params.id?n.dispatch("getPublication",t.params.id):n.commit("setCurrentPublicationLoading",!1);function x(u){const d=u.target.files[0],a=new FileReader;a.onload=()=>{s.value.image=a.result,s.value.image_url=a.result},a.readAsDataURL(d)}function k(){n.dispatch("savePublication",s.value).then(({data:u})=>{n.commit("notify",{type:"success",message:"La publication a bien ete sauvegardee."}),o.push({name:"PublicationView",params:{id:u.data.id}})})}function C(){confirm("Etes vous sur de vouloir supprimer cette publication? Operation irreversible.")&&n.dispatch("deletePublication",s.value.id).then(()=>{o.push({name:"Publications"})})}return(u,d)=>(l(),N(H,null,{header:b(()=>[e("div",I,[e("h1",J,_(i(t).params.id?`Publication ${i(t).params.id}`:"Cr\xE9er une Publication"),1),i(t).params.id?(l(),c("button",{key:0,type:"button",onClick:C,class:"py-2 px-3 text-white bg-red-500 rounded-md hover:bg-red-700"},q)):R("",!0)])]),default:b(()=>[i(w)?(l(),c("div",z,"Chargement...")):(l(),c("form",{key:1,onSubmit:E(k,["prevent"]),class:"animate-fade-in-down"},[e("div",K,[e("div",Q,[e("div",null,[W,e("div",X,[i(s).image_url?(l(),c("img",{key:0,src:i(s).image_url,alt:i(s).title,class:"w-64 h-48 object-cover"},null,8,Y)):(l(),c("span",Z,te)),e("button",oe,[e("input",{type:"file",onChange:x,class:"absolute left-0 top-0 right-0 bottom-0 opacity-0 cursor-pointer"},null,32),se])])]),e("div",null,[ie,v(e("select",{name:"name",id:"name","onUpdate:modelValue":d[0]||(d[0]=a=>i(s).category_id=a),class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},[ae,(l(!0),c(O,null,U(i(m).data,(a,P)=>(l(),c("option",{key:P,value:a.id},_(a.name),9,ne))),128))],512),[[F,i(s).category_id]])]),e("div",null,[re,e("div",le,[v(e("textarea",{id:"description",name:"description",rows:"3","onUpdate:modelValue":d[1]||(d[1]=a=>i(s).description=a),autocomplete:"survey_description",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 mt-1 block w-full sm:text-sm border border-gray-300 rounded-md",placeholder:"D\xE9crire votre publication"},null,512),[[A,i(s).description]])])])]),de])],40,G))]),_:1}))}};export{ge as default};
